---
20-04-2023
---
Минимальная логическая единица XML документа это элемент. У него может быть определено несколько атрибутов (свойств), у любого элемента может быть один непосредственный элемент-владелец и любое количество подчиненных элементов.

# Базовые средства 1С для работы с XML

==Запись данных в XML документ==

```bsl
ЗаписьXML = Новый ЗаписьXML:
ЗаписьXML.ОткрытьФайл("c:/doc.xml");

ЗаписьXML.ЗаписатьОбъявлениеXML();  // запись директивы
ЗаписьXML.ЗаписатьНачалоЭлемента("Корневой");
ЗаписьXML.ЗаписатьАтрибут("ИмяСправочника", "Номенклатура");
ЗаписьXML.ЗаписатьТекст(Значение.Код);
ЗаписьXML.ЗаписатьКонецЭлемента();

ЗаписьXML.Закрыть();
```

Условное представление узла XML
```xml
<ИМЯ АТРИБУТ=значение>
	Содержимое(Текст или описание другого элемента)
</ИМЯ>	
```

Формирование аналогичного узла посредством 1С
```bsl
ЗаписьXML.ЗаписатьНачалоЭлемента("ИМЯ");
ЗаписьXML.ЗаписатьАтрибут("АТРИБУТ", "значение");
ЗаписьXML.ЗаписатьТекст(Текст или другой элемент);
ЗаписьXML.ЗаписатьКонецЭлемента();
```

==Чтение данных из XML документа==

Процесс чтения начинается с создания объекта ЧтениеXML. С помощью метода ОткрытьФайл() указывается имя файла из которого в последствии будет производиться чтение данных.
Само чтение осуществляется с помощью метода Прочитать(). Данный метод возвращает значение Истина если получилось спозиционироваться на следующем узле элемента XML. Для того чтобы понять какой узел является текущим производится обращение к свойству ТипУзла. В случае если это НачалоЭлемента, можно произвести выборку атрибутов (они существуют только в контексте начала элемента). После того как метод Прочитать() возвращает Ложь (достигнут конец документа) работа с XML документом завершается командой Закрыть().

Перечень типов узлов определен в системном перечислении ТипУзлаXML (НачалоЭлемента, Атрибут, Текст, КонецЭлемента, Ничего, ИнструкцияОбработки).

```bsl
Файл = Новый ЧтениеXML;
Файл.ОткрытьФайл("c:/doc.xml");

Пока Файл.Прочитать() Цикл
		
	Если Файл.ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда
		Сообщить(Файл.Имя);	
		Пока Файл.ПрочитатьАтрибут() Цикл
			Сообщить("атрибут: " + Файл.Имя + ", значение " + Файл.Значение);
		КонецЦикла;
	КонецЕсли;

	Если Файл.ТипУзла = ТипУзлаXML.Текст Тогда
		Сообщить(Файл.Значение);
	КонецЕсли;

	Если Файл.ТипУзла = ТипУзлаXML.КонецЭлемента Тогда
		Сообщить("/" + Файл.Имя);
	КонецЕсли;
КонецЦикла;

Файл.Закрыть();
```